---

title: Models


keywords: fastai
sidebar: home_sidebar

summary: "Default SAX Models"
description: "Default SAX Models"
nb_path: "nbs/05_models.ipynb"
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: nbs/05_models.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
        
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Standard-Models">Standard Models<a class="anchor-link" href="#Standard-Models"> </a></h2>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="straight" class="doc_header"><code>straight</code><a href="https://github.com/flaport/sax/sax/models.py#L22" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>straight</code>(<strong><code>wl</code></strong>:<code>float</code>=<em><code>1.55</code></em>, <strong><code>wl0</code></strong>:<code>float</code>=<em><code>1.55</code></em>, <strong><code>neff</code></strong>:<code>float</code>=<em><code>2.34</code></em>, <strong><code>ng</code></strong>:<code>float</code>=<em><code>3.4</code></em>, <strong><code>length</code></strong>:<code>float</code>=<em><code>10.0</code></em>, <strong><code>loss</code></strong>:<code>float</code>=<em><code>0.0</code></em>)-&gt;<a href="/sax/typing.html#SDict"><code>SDict</code></a></p>
</blockquote>
<p>a simple straight waveguide model</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">straight</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>{(&#39;in0&#39;, &#39;out0&#39;): 0.82076+0.57127j, (&#39;out0&#39;, &#39;in0&#39;): 0.82076+0.57127j}</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="coupler" class="doc_header"><code>coupler</code><a href="https://github.com/flaport/sax/sax/models.py#L47" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>coupler</code>(<strong><code>coupling</code></strong>:<code>float</code>=<em><code>0.5</code></em>)-&gt;<a href="/sax/typing.html#SDict"><code>SDict</code></a></p>
</blockquote>
<p>a simple coupler model</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">coupler</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>{(&#39;in0&#39;, &#39;out0&#39;): 0.7071067811865476,
 (&#39;in0&#39;, &#39;out1&#39;): 0.7071067811865476j,
 (&#39;in1&#39;, &#39;out0&#39;): 0.7071067811865476j,
 (&#39;in1&#39;, &#39;out1&#39;): 0.7071067811865476,
 (&#39;out0&#39;, &#39;in0&#39;): 0.7071067811865476,
 (&#39;out1&#39;, &#39;in0&#39;): 0.7071067811865476j,
 (&#39;out0&#39;, &#39;in1&#39;): 0.7071067811865476j,
 (&#39;out1&#39;, &#39;in1&#39;): 0.7071067811865476}</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Model-Factories">Model Factories<a class="anchor-link" href="#Model-Factories"> </a></h2>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="unitary" class="doc_header"><code>unitary</code><a href="https://github.com/flaport/sax/sax/models.py#L102" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>unitary</code>(<strong><code>num_inputs</code></strong>:<code>Optional[int]</code>=<em><code>None</code></em>, <strong><code>num_outputs</code></strong>:<code>Optional[int]</code>=<em><code>None</code></em>, <strong><code>ports</code></strong>:<code>]]</code>=<em><code>None</code></em>, <strong><code>jit</code></strong>=<em><code>True</code></em>, <strong><code>reciprocal</code></strong>=<em><code>True</code></em>, <strong><code>diagonal</code></strong>=<em><code>False</code></em>)-&gt;<a href="/sax/typing.html#Model"><code>Model</code></a></p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>A unitary model returns an <a href="/sax/typing.html#SCoo"><code>SCoo</code></a> by default:</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">unitary_model</span> <span class="o">=</span> <span class="n">unitary</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">unitary_model</span><span class="p">()</span> <span class="c1"># a unitary model returns an SCoo by default</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(array([0, 0, 0, 1, 1, 1, 2, 2, 3, 3, 3]),
 array([0, 2, 3, 1, 2, 3, 0, 1, 0, 1, 3]),
 array([4.9899322e-01, 9.6622550e-01, 2.5769794e-01, 4.9899328e-01,
        2.5769794e-01, 9.6622562e-01, 7.0710677e-01, 7.0710677e-01,
        7.0710677e-01, 7.0710677e-01, 2.3246315e-04]),
 {&#39;in0&#39;: array(0), &#39;in1&#39;: array(1), &#39;out0&#39;: array(2), &#39;out1&#39;: array(3)})</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>As you probably already know, it's very easy to convert a model returning any <code>Stype</code> into a model returning an <a href="/sax/typing.html#SDict"><code>SDict</code></a> as follows:</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">unitary_sdict_model</span> <span class="o">=</span> <span class="n">sax</span><span class="o">.</span><span class="n">sdict</span><span class="p">(</span><span class="n">unitary_model</span><span class="p">)</span>
<span class="n">unitary_sdict_model</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>{(&#39;in0&#39;, &#39;in0&#39;): 0.49899,
 (&#39;in0&#39;, &#39;out0&#39;): 0.96623,
 (&#39;in0&#39;, &#39;out1&#39;): 0.2577,
 (&#39;in1&#39;, &#39;in1&#39;): 0.49899,
 (&#39;in1&#39;, &#39;out0&#39;): 0.2577,
 (&#39;in1&#39;, &#39;out1&#39;): 0.96623,
 (&#39;out0&#39;, &#39;in0&#39;): 0.70711,
 (&#39;out0&#39;, &#39;in1&#39;): 0.70711,
 (&#39;out1&#39;, &#39;in0&#39;): 0.70711,
 (&#39;out1&#39;, &#39;in1&#39;): 0.70711,
 (&#39;out1&#39;, &#39;out1&#39;): 0.00023}</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>If we need custom port names, we can also just specify them explicitly:</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">unitary_model</span> <span class="o">=</span> <span class="n">unitary</span><span class="p">(</span><span class="n">ports</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;in0&quot;</span><span class="p">,</span> <span class="s2">&quot;in1&quot;</span><span class="p">,</span> <span class="s2">&quot;out0&quot;</span><span class="p">,</span> <span class="s2">&quot;out1&quot;</span><span class="p">))</span>
<span class="n">unitary_model</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(array([0, 0, 0, 1, 1, 1, 2, 2, 3, 3, 3]),
 array([0, 2, 3, 1, 2, 3, 0, 1, 0, 1, 3]),
 array([4.9899322e-01, 9.6622550e-01, 2.5769794e-01, 4.9899328e-01,
        2.5769794e-01, 9.6622562e-01, 7.0710677e-01, 7.0710677e-01,
        7.0710677e-01, 7.0710677e-01, 2.3246315e-04]),
 {&#39;in0&#39;: array(0), &#39;in1&#39;: array(1), &#39;out0&#39;: array(2), &#39;out1&#39;: array(3)})</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>A unitary model will by default split a signal at an input port equally over all output ports. However, if there are an equal number of input ports as output ports we can in stead create a passthru by setting the <code>diagonal</code> flag to <code>True</code>:</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">passthru_model</span> <span class="o">=</span> <span class="n">unitary</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">diagonal</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">sax</span><span class="o">.</span><span class="n">sdict</span><span class="p">(</span><span class="n">passthru_model</span><span class="p">())</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>{(&#39;in0&#39;, &#39;out0&#39;): 1.0,
 (&#39;in1&#39;, &#39;out1&#39;): 1.0,
 (&#39;out0&#39;, &#39;in0&#39;): 1.0,
 (&#39;out1&#39;, &#39;in1&#39;): 1.0}</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">ports_in</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;in0&#39;</span><span class="p">]</span>
<span class="n">ports_out</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;out0&#39;</span><span class="p">,</span> <span class="s1">&#39;out1&#39;</span><span class="p">,</span> <span class="s1">&#39;out2&#39;</span><span class="p">,</span> <span class="s1">&#39;out3&#39;</span><span class="p">,</span> <span class="s1">&#39;out4&#39;</span><span class="p">]</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">unitary</span><span class="p">(</span>
    <span class="n">ports</span><span class="o">=</span><span class="nb">tuple</span><span class="p">(</span><span class="n">ports_in</span><span class="o">+</span><span class="n">ports_out</span><span class="p">),</span> <span class="n">jit</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">reciprocal</span><span class="o">=</span><span class="kc">True</span>
<span class="p">)</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">sax</span><span class="o">.</span><span class="n">sdict</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
<span class="n">model</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>{(&#39;in0&#39;, &#39;in0&#39;): 0.89409,
 (&#39;in0&#39;, &#39;out0&#39;): 0.44721,
 (&#39;in0&#39;, &#39;out1&#39;): 0.44721,
 (&#39;in0&#39;, &#39;out2&#39;): 0.44721,
 (&#39;in0&#39;, &#39;out3&#39;): 0.44721,
 (&#39;in0&#39;, &#39;out4&#39;): 0.44721,
 (&#39;out0&#39;, &#39;in0&#39;): 0.45508,
 (&#39;out0&#39;, &#39;out0&#39;): 7.339056901400909e-05,
 (&#39;out0&#39;, &#39;out1&#39;): 7.339056901400909e-05,
 (&#39;out0&#39;, &#39;out2&#39;): 7.339056901400909e-05,
 (&#39;out0&#39;, &#39;out3&#39;): 7.339056901400909e-05,
 (&#39;out0&#39;, &#39;out4&#39;): 7.339056901400909e-05,
 (&#39;out1&#39;, &#39;in0&#39;): 0.45508,
 (&#39;out1&#39;, &#39;out0&#39;): 7.339056901400909e-05,
 (&#39;out1&#39;, &#39;out1&#39;): 7.339056901400909e-05,
 (&#39;out1&#39;, &#39;out2&#39;): 7.339056901400909e-05,
 (&#39;out1&#39;, &#39;out3&#39;): 7.339056901400909e-05,
 (&#39;out1&#39;, &#39;out4&#39;): 7.339056901400909e-05,
 (&#39;out2&#39;, &#39;in0&#39;): 0.45508,
 (&#39;out2&#39;, &#39;out0&#39;): 7.339056901400909e-05,
 (&#39;out2&#39;, &#39;out1&#39;): 7.339056901400909e-05,
 (&#39;out2&#39;, &#39;out2&#39;): 7.339056901400909e-05,
 (&#39;out2&#39;, &#39;out3&#39;): 7.339056901400909e-05,
 (&#39;out2&#39;, &#39;out4&#39;): 7.339056901400909e-05,
 (&#39;out3&#39;, &#39;in0&#39;): 0.45508,
 (&#39;out3&#39;, &#39;out0&#39;): 7.339056901400909e-05,
 (&#39;out3&#39;, &#39;out1&#39;): 7.339056901400909e-05,
 (&#39;out3&#39;, &#39;out2&#39;): 7.339056901400909e-05,
 (&#39;out3&#39;, &#39;out3&#39;): 7.339056901400909e-05,
 (&#39;out3&#39;, &#39;out4&#39;): 7.339056901400909e-05,
 (&#39;out4&#39;, &#39;in0&#39;): 0.41426,
 (&#39;out4&#39;, &#39;out0&#39;): 0.00012,
 (&#39;out4&#39;, &#39;out1&#39;): 0.00012,
 (&#39;out4&#39;, &#39;out2&#39;): 0.00012,
 (&#39;out4&#39;, &#39;out3&#39;): 0.00012,
 (&#39;out4&#39;, &#39;out4&#39;): 0.00012}</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Because this is a pretty common usecase we have a dedicated model factory for this as well. This passthru component just takes the number of links (<code>'in{i}' -&gt; 'out{i]'</code>) as input. Alternatively, as before, one can also specify the port names directly but one needs to ensure that <code>len(ports) == 2*num_links</code>.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="passthru" class="doc_header"><code>passthru</code><a href="https://github.com/flaport/sax/sax/models.py#L230" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>passthru</code>(<strong><code>num_links</code></strong>:<code>Optional[int]</code>=<em><code>None</code></em>, <strong><code>ports</code></strong>:<code>]]</code>=<em><code>None</code></em>, <strong><code>jit</code></strong>=<em><code>True</code></em>, <strong><code>reciprocal</code></strong>=<em><code>True</code></em>)-&gt;<a href="/sax/typing.html#Model"><code>Model</code></a></p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">passthru_model</span> <span class="o">=</span> <span class="n">passthru</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="n">passthru_sdict_model</span> <span class="o">=</span> <span class="n">sax</span><span class="o">.</span><span class="n">sdict</span><span class="p">(</span><span class="n">passthru_model</span><span class="p">)</span>
<span class="n">passthru_sdict_model</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>{(&#39;in0&#39;, &#39;out0&#39;): 1.0,
 (&#39;in1&#39;, &#39;out1&#39;): 1.0,
 (&#39;in2&#39;, &#39;out2&#39;): 1.0,
 (&#39;out0&#39;, &#39;in0&#39;): 1.0,
 (&#39;out1&#39;, &#39;in1&#39;): 1.0,
 (&#39;out2&#39;, &#39;in2&#39;): 1.0}</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">mzi</span> <span class="o">=</span> <span class="n">sax</span><span class="o">.</span><span class="n">circuit</span><span class="p">(</span>
    <span class="n">instances</span><span class="o">=</span><span class="p">{</span>
        <span class="s2">&quot;lft&quot;</span><span class="p">:</span> <span class="n">unitary</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span>
        <span class="s2">&quot;top&quot;</span><span class="p">:</span> <span class="n">unitary</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
        <span class="s2">&quot;rgt&quot;</span><span class="p">:</span> <span class="n">unitary</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span>
    <span class="p">},</span>
    <span class="n">connections</span><span class="o">=</span><span class="p">{</span>
        <span class="s2">&quot;lft,out0&quot;</span><span class="p">:</span> <span class="s2">&quot;rgt,out0&quot;</span><span class="p">,</span>
        <span class="s2">&quot;lft,out1&quot;</span><span class="p">:</span> <span class="s2">&quot;top,in0&quot;</span><span class="p">,</span>
        <span class="s2">&quot;top,out0&quot;</span><span class="p">:</span> <span class="s2">&quot;rgt,out1&quot;</span><span class="p">,</span>
    <span class="p">},</span>
    <span class="n">ports</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;in0&quot;</span><span class="p">:</span> <span class="s2">&quot;lft,in0&quot;</span><span class="p">,</span>
        <span class="s2">&quot;out0&quot;</span><span class="p">:</span> <span class="s2">&quot;rgt,in0&quot;</span><span class="p">,</span>
    <span class="p">}</span>
<span class="p">)</span>
<span class="n">mzi</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>{(&#39;in0&#39;, &#39;in0&#39;): 0.49904,
 (&#39;out0&#39;, &#39;out0&#39;): 0.49904,
 (&#39;out0&#39;, &#39;in0&#39;): 0.86544,
 (&#39;in0&#39;, &#39;out0&#39;): 0.86544}</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="copier" class="doc_header"><code>copier</code><a href="https://github.com/flaport/sax/sax/models.py#L179" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>copier</code>(<strong><code>num_inputs</code></strong>:<code>Optional[int]</code>=<em><code>None</code></em>, <strong><code>num_outputs</code></strong>:<code>Optional[int]</code>=<em><code>None</code></em>, <strong><code>ports</code></strong>:<code>]]</code>=<em><code>None</code></em>, <strong><code>jit</code></strong>=<em><code>True</code></em>, <strong><code>reciprocal</code></strong>=<em><code>True</code></em>, <strong><code>diagonal</code></strong>=<em><code>False</code></em>)-&gt;<a href="/sax/typing.html#Model"><code>Model</code></a></p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>A copier model is like a unitary model, but copies the input signal over all output signals. Hence, if the model has multiple output ports, this model can be considered to introduce gain. That said, it can sometimes be a useful component.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">copier_model</span> <span class="o">=</span> <span class="n">copier</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">copier_model</span><span class="p">()</span> <span class="c1"># a copier model returns an SCoo by default</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(array([0, 0, 1, 1, 2, 2, 3, 3]),
 array([2, 3, 2, 3, 0, 1, 0, 1]),
 array([1., 1., 1., 1., 1., 1., 1., 1.]),
 {&#39;in0&#39;: array(0), &#39;in1&#39;: array(1), &#39;out0&#39;: array(2), &#39;out1&#39;: array(3)})</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>As you probably already know, it's very easy to convert a model returning any <code>Stype</code> into a model returning an <a href="/sax/typing.html#SDict"><code>SDict</code></a> as follows:</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">copier_sdict_model</span> <span class="o">=</span> <span class="n">sax</span><span class="o">.</span><span class="n">sdict</span><span class="p">(</span><span class="n">copier_model</span><span class="p">)</span>
<span class="n">copier_sdict_model</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>{(&#39;in0&#39;, &#39;out0&#39;): 1.0,
 (&#39;in0&#39;, &#39;out1&#39;): 1.0,
 (&#39;in1&#39;, &#39;out0&#39;): 1.0,
 (&#39;in1&#39;, &#39;out1&#39;): 1.0,
 (&#39;out0&#39;, &#39;in0&#39;): 1.0,
 (&#39;out0&#39;, &#39;in1&#39;): 1.0,
 (&#39;out1&#39;, &#39;in0&#39;): 1.0,
 (&#39;out1&#39;, &#39;in1&#39;): 1.0}</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>If we need custom port names, we can also just specify them explicitly:</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">copier_model</span> <span class="o">=</span> <span class="n">copier</span><span class="p">(</span><span class="n">ports</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;in0&quot;</span><span class="p">,</span> <span class="s2">&quot;in1&quot;</span><span class="p">,</span> <span class="s2">&quot;out0&quot;</span><span class="p">,</span> <span class="s2">&quot;out1&quot;</span><span class="p">))</span>
<span class="n">copier_model</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(array([0, 0, 1, 1, 2, 2, 3, 3]),
 array([2, 3, 2, 3, 0, 1, 0, 1]),
 array([1., 1., 1., 1., 1., 1., 1., 1.]),
 {&#39;in0&#39;: array(0), &#39;in1&#39;: array(1), &#39;out0&#39;: array(2), &#39;out1&#39;: array(3)})</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">ports_in</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;in0&#39;</span><span class="p">]</span>
<span class="n">ports_out</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;out0&#39;</span><span class="p">,</span> <span class="s1">&#39;out1&#39;</span><span class="p">,</span> <span class="s1">&#39;out2&#39;</span><span class="p">,</span> <span class="s1">&#39;out3&#39;</span><span class="p">,</span> <span class="s1">&#39;out4&#39;</span><span class="p">]</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">unitary</span><span class="p">(</span>
    <span class="n">ports</span><span class="o">=</span><span class="nb">tuple</span><span class="p">(</span><span class="n">ports_in</span><span class="o">+</span><span class="n">ports_out</span><span class="p">),</span> <span class="n">jit</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">reciprocal</span><span class="o">=</span><span class="kc">True</span>
<span class="p">)</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">sax</span><span class="o">.</span><span class="n">sdict</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
<span class="n">model</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>{(&#39;in0&#39;, &#39;in0&#39;): 0.89409,
 (&#39;in0&#39;, &#39;out0&#39;): 0.44721,
 (&#39;in0&#39;, &#39;out1&#39;): 0.44721,
 (&#39;in0&#39;, &#39;out2&#39;): 0.44721,
 (&#39;in0&#39;, &#39;out3&#39;): 0.44721,
 (&#39;in0&#39;, &#39;out4&#39;): 0.44721,
 (&#39;out0&#39;, &#39;in0&#39;): 0.45508,
 (&#39;out0&#39;, &#39;out0&#39;): 7.339056901400909e-05,
 (&#39;out0&#39;, &#39;out1&#39;): 7.339056901400909e-05,
 (&#39;out0&#39;, &#39;out2&#39;): 7.339056901400909e-05,
 (&#39;out0&#39;, &#39;out3&#39;): 7.339056901400909e-05,
 (&#39;out0&#39;, &#39;out4&#39;): 7.339056901400909e-05,
 (&#39;out1&#39;, &#39;in0&#39;): 0.45508,
 (&#39;out1&#39;, &#39;out0&#39;): 7.339056901400909e-05,
 (&#39;out1&#39;, &#39;out1&#39;): 7.339056901400909e-05,
 (&#39;out1&#39;, &#39;out2&#39;): 7.339056901400909e-05,
 (&#39;out1&#39;, &#39;out3&#39;): 7.339056901400909e-05,
 (&#39;out1&#39;, &#39;out4&#39;): 7.339056901400909e-05,
 (&#39;out2&#39;, &#39;in0&#39;): 0.45508,
 (&#39;out2&#39;, &#39;out0&#39;): 7.339056901400909e-05,
 (&#39;out2&#39;, &#39;out1&#39;): 7.339056901400909e-05,
 (&#39;out2&#39;, &#39;out2&#39;): 7.339056901400909e-05,
 (&#39;out2&#39;, &#39;out3&#39;): 7.339056901400909e-05,
 (&#39;out2&#39;, &#39;out4&#39;): 7.339056901400909e-05,
 (&#39;out3&#39;, &#39;in0&#39;): 0.45508,
 (&#39;out3&#39;, &#39;out0&#39;): 7.339056901400909e-05,
 (&#39;out3&#39;, &#39;out1&#39;): 7.339056901400909e-05,
 (&#39;out3&#39;, &#39;out2&#39;): 7.339056901400909e-05,
 (&#39;out3&#39;, &#39;out3&#39;): 7.339056901400909e-05,
 (&#39;out3&#39;, &#39;out4&#39;): 7.339056901400909e-05,
 (&#39;out4&#39;, &#39;in0&#39;): 0.41426,
 (&#39;out4&#39;, &#39;out0&#39;): 0.00012,
 (&#39;out4&#39;, &#39;out1&#39;): 0.00012,
 (&#39;out4&#39;, &#39;out2&#39;): 0.00012,
 (&#39;out4&#39;, &#39;out3&#39;): 0.00012,
 (&#39;out4&#39;, &#39;out4&#39;): 0.00012}</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Because this is a pretty common usecase we have a dedicated model factory for this as well. This passthru component just takes the number of links (<code>'in{i}' -&gt; 'out{i]'</code>) as input. Alternatively, as before, one can also specify the port names directly but one needs to ensure that <code>len(ports) == 2*num_links</code>.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="passthru" class="doc_header"><code>passthru</code><a href="https://github.com/flaport/sax/sax/models.py#L230" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>passthru</code>(<strong><code>num_links</code></strong>:<code>Optional[int]</code>=<em><code>None</code></em>, <strong><code>ports</code></strong>:<code>]]</code>=<em><code>None</code></em>, <strong><code>jit</code></strong>=<em><code>True</code></em>, <strong><code>reciprocal</code></strong>=<em><code>True</code></em>)-&gt;<a href="/sax/typing.html#Model"><code>Model</code></a></p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">passthru_model</span> <span class="o">=</span> <span class="n">passthru</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="n">passthru_sdict_model</span> <span class="o">=</span> <span class="n">sax</span><span class="o">.</span><span class="n">sdict</span><span class="p">(</span><span class="n">passthru_model</span><span class="p">)</span>
<span class="n">passthru_sdict_model</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>{(&#39;in0&#39;, &#39;out0&#39;): 1.0,
 (&#39;in1&#39;, &#39;out1&#39;): 1.0,
 (&#39;in2&#39;, &#39;out2&#39;): 1.0,
 (&#39;out0&#39;, &#39;in0&#39;): 1.0,
 (&#39;out1&#39;, &#39;in1&#39;): 1.0,
 (&#39;out2&#39;, &#39;in2&#39;): 1.0}</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">mzi</span> <span class="o">=</span> <span class="n">sax</span><span class="o">.</span><span class="n">circuit</span><span class="p">(</span>
    <span class="n">instances</span><span class="o">=</span><span class="p">{</span>
        <span class="s2">&quot;lft&quot;</span><span class="p">:</span> <span class="n">unitary</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span>
        <span class="s2">&quot;top&quot;</span><span class="p">:</span> <span class="n">unitary</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
        <span class="s2">&quot;rgt&quot;</span><span class="p">:</span> <span class="n">unitary</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span>
    <span class="p">},</span>
    <span class="n">connections</span><span class="o">=</span><span class="p">{</span>
        <span class="s2">&quot;lft,out0&quot;</span><span class="p">:</span> <span class="s2">&quot;rgt,out0&quot;</span><span class="p">,</span>
        <span class="s2">&quot;lft,out1&quot;</span><span class="p">:</span> <span class="s2">&quot;top,in0&quot;</span><span class="p">,</span>
        <span class="s2">&quot;top,out0&quot;</span><span class="p">:</span> <span class="s2">&quot;rgt,out1&quot;</span><span class="p">,</span>
    <span class="p">},</span>
    <span class="n">ports</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;in0&quot;</span><span class="p">:</span> <span class="s2">&quot;lft,in0&quot;</span><span class="p">,</span>
        <span class="s2">&quot;out0&quot;</span><span class="p">:</span> <span class="s2">&quot;rgt,in0&quot;</span><span class="p">,</span>
    <span class="p">}</span>
<span class="p">)</span>
<span class="n">mzi</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>{(&#39;in0&#39;, &#39;in0&#39;): 0.49904,
 (&#39;out0&#39;, &#39;out0&#39;): 0.49904,
 (&#39;out0&#39;, &#39;in0&#39;): 0.86544,
 (&#39;in0&#39;, &#39;out0&#39;): 0.86544}</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="All-Models">All Models<a class="anchor-link" href="#All-Models"> </a></h2>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="get_models" class="doc_header"><code>get_models</code><a href="https://github.com/flaport/sax/sax/models.py#L255" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>get_models</code>(<strong><code>copy</code></strong>:<code>bool</code>=<em><code>True</code></em>)-&gt;<code>None</code></p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">models</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;copier&quot;</span><span class="p">:</span> <span class="n">copier</span><span class="p">,</span>
    <span class="s2">&quot;coupler&quot;</span><span class="p">:</span> <span class="n">coupler</span><span class="p">,</span>
    <span class="s2">&quot;passthru&quot;</span><span class="p">:</span> <span class="n">passthru</span><span class="p">,</span>
    <span class="s2">&quot;straight&quot;</span><span class="p">:</span> <span class="n">straight</span><span class="p">,</span>
    <span class="s2">&quot;unitary&quot;</span><span class="p">:</span> <span class="n">unitary</span><span class="p">,</span>
<span class="p">}</span>

<span class="k">def</span> <span class="nf">get_models</span><span class="p">(</span><span class="n">copy</span><span class="p">:</span> <span class="nb">bool</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">copy</span><span class="p">:</span>
        <span class="k">return</span> <span class="p">{</span><span class="o">**</span><span class="n">models</span><span class="p">}</span>
    <span class="k">return</span> <span class="n">models</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

</div>
 

