---

title: Typing


keywords: fastai
sidebar: home_sidebar

summary: "SAX types"
description: "SAX types"
nb_path: "nbs/00_typing.ipynb"
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: nbs/00_typing.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
        
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Core-Types">Core Types<a class="anchor-link" href="#Core-Types"> </a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Array">Array<a class="anchor-link" href="#Array"> </a></h4>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>an <a href="/sax/typing.html#Array"><code>Array</code></a> is either a jax array or a numpy array:</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">Array</span> <span class="o">=</span> <span class="n">Union</span><span class="p">[</span><span class="n">jnp</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Int">Int<a class="anchor-link" href="#Int"> </a></h4>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>An <a href="/sax/typing.html#Int"><code>Int</code></a> is either a built-in <code>int</code> or an <a href="/sax/typing.html#Array"><code>Array</code></a> [of dtype <code>int</code>]</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">Int</span> <span class="o">=</span> <span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="n">Array</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Float">Float<a class="anchor-link" href="#Float"> </a></h4>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>A <a href="/sax/typing.html#Float"><code>Float</code></a> is eiter a built-in <code>float</code> or an <a href="/sax/typing.html#Array"><code>Array</code></a> [of dtype <code>float</code>]</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">Float</span> <span class="o">=</span> <span class="n">Union</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="n">Array</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="ComplexFloat">ComplexFloat<a class="anchor-link" href="#ComplexFloat"> </a></h4>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>A <a href="/sax/typing.html#ComplexFloat"><code>ComplexFloat</code></a> is either a build-in <code>complex</code> or an Array [of dtype <code>complex</code>]:</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">ComplexFloat</span> <span class="o">=</span> <span class="n">Union</span><span class="p">[</span><span class="nb">complex</span><span class="p">,</span> <span class="n">Float</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Settings">Settings<a class="anchor-link" href="#Settings"> </a></h4>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>A <a href="/sax/typing.html#Settings"><code>Settings</code></a> dictionary is a nested mapping between setting names [<code>str</code>] to either <a href="/sax/typing.html#ComplexFloat"><code>ComplexFloat</code></a> values OR to another lower level <a href="/sax/typing.html#Settings"><code>Settings</code></a> dictionary.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">Settings</span> <span class="o">=</span> <span class="n">Union</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">ComplexFloat</span><span class="p">],</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="s2">&quot;Settings&quot;</span><span class="p">]]</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Settings dictionaries are used to parametrize a SAX <a href="/sax/typing.html#Model"><code>Model</code></a> or a <a href="/sax/circuit.html#circuit"><code>circuit</code></a>. The settings dictionary should have the same hierarchy levels as the circuit:</p>
<blockquote><p>Example:</p>
</blockquote>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">mzi_settings</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;wl&quot;</span><span class="p">:</span> <span class="mf">1.5</span><span class="p">,</span>  <span class="c1"># global settings</span>
    <span class="s2">&quot;lft&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;coupling&quot;</span><span class="p">:</span> <span class="mf">0.5</span><span class="p">},</span>  <span class="c1"># settings for the left coupler</span>
    <span class="s2">&quot;top&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;neff&quot;</span><span class="p">:</span> <span class="mf">3.4</span><span class="p">},</span>  <span class="c1"># settings for the top waveguide</span>
    <span class="s2">&quot;rgt&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;coupling&quot;</span><span class="p">:</span> <span class="mf">0.3</span><span class="p">},</span>  <span class="c1"># settings for the right coupler</span>
<span class="p">}</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="SDict">SDict<a class="anchor-link" href="#SDict"> </a></h4>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>An <a href="/sax/typing.html#SDict"><code>SDict</code></a> is a sparse dictionary based representation of an S-matrix, mapping port name tuples such as <code>('in0', 'out0')</code> to <a href="/sax/typing.html#ComplexFloat"><code>ComplexFloat</code></a>.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">SDict</span> <span class="o">=</span> <span class="n">Dict</span><span class="p">[</span><span class="n">Tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">],</span> <span class="n">ComplexFloat</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<blockquote><p>Example:</p>
</blockquote>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">_sdict</span><span class="p">:</span> <span class="n">SDict</span> <span class="o">=</span> <span class="p">{</span>
    <span class="p">(</span><span class="s2">&quot;in0&quot;</span><span class="p">,</span> <span class="s2">&quot;out0&quot;</span><span class="p">):</span> <span class="mf">3.0</span><span class="p">,</span>
<span class="p">}</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="SCoo">SCoo<a class="anchor-link" href="#SCoo"> </a></h4>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>An <a href="/sax/typing.html#SCoo"><code>SCoo</code></a> is a sparse matrix based representation of an S-matrix consisting of three arrays and a port map. The three arrays represent the input port indices [<code>int</code>], output port indices [<code>int</code>] and the S-matrix values [<a href="/sax/typing.html#ComplexFloat"><code>ComplexFloat</code></a>] of the sparse matrix. The port map maps a port name [<code>str</code>] to a port index [<code>int</code>]. Only these four arrays <strong>together</strong> and in this specific <strong>order</strong> are considered a valid <a href="/sax/typing.html#SCoo"><code>SCoo</code></a> representation!</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">SCoo</span> <span class="o">=</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">Array</span><span class="p">,</span> <span class="n">Array</span><span class="p">,</span> <span class="n">ComplexFloat</span><span class="p">,</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">int</span><span class="p">]]</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<blockquote><p>Example:</p>
</blockquote>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">Si</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>
<span class="n">Sj</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>
<span class="n">Sx</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">3.0</span><span class="p">,</span> <span class="mf">4.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">])</span>
<span class="n">port_map</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;in0&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;in1&quot;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s2">&quot;out0&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">}</span>
<span class="n">_scoo</span><span class="p">:</span> <span class="n">SCoo</span> <span class="o">=</span> <span class="n">Si</span><span class="p">,</span> <span class="n">Sj</span><span class="p">,</span> <span class="n">Sx</span><span class="p">,</span> <span class="n">port_map</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="SDense">SDense<a class="anchor-link" href="#SDense"> </a></h4>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>an <a href="/sax/typing.html#SDense"><code>SDense</code></a> is a dense matrix representation of an S-matrix. It's represented by an NxN <a href="/sax/typing.html#ComplexFloat"><code>ComplexFloat</code></a> array and a port map (mapping port names onto port indices).</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">SDense</span> <span class="o">=</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">Array</span><span class="p">,</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">int</span><span class="p">]]</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<blockquote><p>Example:</p>
</blockquote>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">Sd</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">9</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="n">port_map</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;in0&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;in1&quot;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s2">&quot;out0&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">}</span>
<span class="n">_sdense</span> <span class="o">=</span> <span class="n">Sd</span><span class="p">,</span> <span class="n">port_map</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="SType">SType<a class="anchor-link" href="#SType"> </a></h4>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>an <a href="/sax/typing.html#SType"><code>SType</code></a> is either an <a href="/sax/typing.html#SDict"><code>SDict</code></a> <strong>OR</strong> an <a href="/sax/typing.html#SCoo"><code>SCoo</code></a> <strong>OR</strong> an <a href="/sax/typing.html#SDense"><code>SDense</code></a>:</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">SType</span> <span class="o">=</span> <span class="n">Union</span><span class="p">[</span><span class="n">SDict</span><span class="p">,</span> <span class="n">SCoo</span><span class="p">,</span> <span class="n">SDense</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<blockquote><p>Example:</p>
</blockquote>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">obj</span><span class="p">:</span> <span class="n">SType</span> <span class="o">=</span> <span class="n">_sdict</span>
<span class="n">obj</span><span class="p">:</span> <span class="n">SType</span> <span class="o">=</span> <span class="n">_scoo</span>
<span class="n">obj</span><span class="p">:</span> <span class="n">SType</span> <span class="o">=</span> <span class="n">_sdense</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Model">Model<a class="anchor-link" href="#Model"> </a></h4>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>A <a href="/sax/typing.html#Model"><code>Model</code></a> is any keyword-only function that returns an <a href="/sax/typing.html#SType"><code>SType</code></a>:</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">Model</span> <span class="o">=</span> <span class="n">Callable</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="n">SType</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="ModelFactory">ModelFactory<a class="anchor-link" href="#ModelFactory"> </a></h4>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>A <a href="/sax/typing.html#ModelFactory"><code>ModelFactory</code></a> is any keyword-only function that returns a <a href="/sax/typing.html#Model"><code>Model</code></a>:</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">ModelFactory</span> <span class="o">=</span> <span class="n">Callable</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="n">Model</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>{% include note.html content='SAX sometimes needs to figure out the difference between a <a href="/sax/typing.html#ModelFactory"><code>ModelFactory</code></a> and a normal <a href="/sax/typing.html#Model"><code>Model</code></a> <em>before</em> running the function. To do this, SAX will check the return annotation of the function. Any function with a <code>-&gt; Model</code> or <code>-&gt; Callable</code> annotation will be considered a <a href="/sax/typing.html#ModelFactory"><code>ModelFactory</code></a>. Any function without this annotation will be considered a normal Model: <strong>don&#8217;t forget the return annotation of your Model Factory!</strong> To ensure a correct annotation and to ensure forward compatibility, it&#8217;s recommended to decorate your <a href="/sax/typing.html#ModelFactory"><code>ModelFactory</code></a> with the <a href="/sax/typing.html#modelfactory"><code>modelfactory</code></a> decorator.' %}</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="GeneralModel">GeneralModel<a class="anchor-link" href="#GeneralModel"> </a></h4>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>a <a href="/sax/typing.html#GeneralModel"><code>GeneralModel</code></a> is either a <a href="/sax/typing.html#Model"><code>Model</code></a> or a <a href="/sax/typing.html#LogicalNetlist"><code>LogicalNetlist</code></a> (will be defined below):</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">GeneralModel</span> <span class="o">=</span> <span class="n">Union</span><span class="p">[</span><span class="n">Model</span><span class="p">,</span> <span class="s2">&quot;LogicalNetlist&quot;</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Models">Models<a class="anchor-link" href="#Models"> </a></h4>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><a href="/sax/typing.html#Models"><code>Models</code></a> is a mapping between model names [<code>str</code>] and <a href="/sax/typing.html#GeneralModel"><code>GeneralModel</code></a>:</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">Models</span> <span class="o">=</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">GeneralModel</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>{% include note.html content='sometimes &#8217;component&#8217; is used to refer to a a <a href="/sax/typing.html#Model"><code>Model</code></a> or <a href="/sax/typing.html#GeneralModel"><code>GeneralModel</code></a>. This is because other tools (such as for example GDSFactory) prefer that terminology.' %}</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Netlist-Types">Netlist Types<a class="anchor-link" href="#Netlist-Types"> </a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Instance">Instance<a class="anchor-link" href="#Instance"> </a></h4>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>A netlist <a href="/sax/typing.html#Instance"><code>Instance</code></a> is a mapping with two keys: <code>"component"</code>, which should map to a key in a <a href="/sax/typing.html#Models"><code>Models</code></a> dictionary and <code>"settings"</code>, which are all the necessary settings to instanciate a component:</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">Instance</span> <span class="o">=</span> <span class="n">TypedDict</span><span class="p">(</span>
    <span class="s2">&quot;Instance&quot;</span><span class="p">,</span>
    <span class="p">{</span>
        <span class="s2">&quot;component&quot;</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="s2">&quot;settings&quot;</span><span class="p">:</span> <span class="n">Settings</span><span class="p">,</span>
    <span class="p">},</span>
<span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>{% include note.html content='in SAX, a better name for <code>"component"</code> in the instance definition would probably be <code>"model"</code> or <code>"model_name"</code>. However we chose <code>"component"</code> here to have a 1-to-1 map between SAX netlists and GDSFactory netlists.' %}</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="GeneralInstance">GeneralInstance<a class="anchor-link" href="#GeneralInstance"> </a></h4>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>A general instance can be any of the following (<a href="/sax/typing.html#LogicalNetlist"><code>LogicalNetlist</code></a> and <a href="/sax/typing.html#Netlist"><code>Netlist</code></a> will be defined below):</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">GeneralInstance</span> <span class="o">=</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Instance</span><span class="p">,</span> <span class="s2">&quot;LogicalNetlist&quot;</span><span class="p">,</span> <span class="s2">&quot;Netlist&quot;</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<blockquote><p>For example, this is allowed:</p>
</blockquote>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">inst</span><span class="p">:</span> <span class="n">GeneralInstance</span> <span class="o">=</span> <span class="s2">&quot;my_component_model&quot;</span>
<span class="n">inst</span><span class="p">:</span> <span class="n">GeneralInstance</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;component&quot;</span><span class="p">:</span> <span class="s2">&quot;my_component_model&quot;</span><span class="p">,</span>
    <span class="s2">&quot;settings&quot;</span><span class="p">:</span> <span class="p">{},</span>
<span class="p">}</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<blockquote><p>... and this is not (will be flagged by a static type checker like pyright or mypy):</p>
</blockquote>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">inst</span><span class="p">:</span> <span class="n">GeneralInstance</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;component&quot;</span><span class="p">:</span> <span class="s2">&quot;my_component_model&quot;</span><span class="p">,</span>
    <span class="s2">&quot;settings&quot;</span><span class="p">:</span> <span class="p">{},</span>
    <span class="s2">&quot;extra_arg&quot;</span><span class="p">:</span> <span class="s2">&quot;invalid&quot;</span><span class="p">,</span>
<span class="p">}</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Instances">Instances<a class="anchor-link" href="#Instances"> </a></h4>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><a href="/sax/typing.html#Instances"><code>Instances</code></a> is a mapping from instance names [<code>str</code>] to a <a href="/sax/typing.html#GeneralInstance"><code>GeneralInstance</code></a>:</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">Instances</span> <span class="o">=</span> <span class="n">Union</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">],</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">GeneralInstance</span><span class="p">]]</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Netlist">Netlist<a class="anchor-link" href="#Netlist"> </a></h4>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>a <a href="/sax/typing.html#Netlist"><code>Netlist</code></a> is a collection of <code>"instances"</code>, <code>"connections"</code> and <code>"ports"</code>:</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">Netlist</span> <span class="o">=</span> <span class="n">TypedDict</span><span class="p">(</span>
    <span class="s2">&quot;Netlist&quot;</span><span class="p">,</span>
    <span class="p">{</span>
        <span class="s2">&quot;instances&quot;</span><span class="p">:</span> <span class="n">Instances</span><span class="p">,</span>
        <span class="s2">&quot;connections&quot;</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">],</span>
        <span class="s2">&quot;ports&quot;</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">],</span>
    <span class="p">},</span>
<span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<blockquote><p>Example:</p>
</blockquote>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">mzi_netlist</span><span class="p">:</span> <span class="n">Netlist</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;instances&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;lft&quot;</span><span class="p">:</span> <span class="s2">&quot;mmi1x2&quot;</span><span class="p">,</span>  <span class="c1"># shorthand if no settings need to be given</span>
        <span class="s2">&quot;top&quot;</span><span class="p">:</span> <span class="p">{</span>  <span class="c1"># full instance definition</span>
            <span class="s2">&quot;component&quot;</span><span class="p">:</span> <span class="s2">&quot;waveguide&quot;</span><span class="p">,</span>
            <span class="s2">&quot;settings&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;length&quot;</span><span class="p">:</span> <span class="mf">100.0</span><span class="p">,</span>
            <span class="p">},</span>
        <span class="p">},</span>
        <span class="s2">&quot;rgt&quot;</span><span class="p">:</span> <span class="s2">&quot;mmi2x2&quot;</span><span class="p">,</span>  <span class="c1"># shorthand if no settings need to be given</span>
    <span class="p">},</span>
    <span class="s2">&quot;connections&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;lft,out0&quot;</span><span class="p">:</span> <span class="s2">&quot;top,in0&quot;</span><span class="p">,</span>
        <span class="s2">&quot;top,out0&quot;</span><span class="p">:</span> <span class="s2">&quot;rgt,in0&quot;</span><span class="p">,</span>
        <span class="s2">&quot;top,out1&quot;</span><span class="p">:</span> <span class="s2">&quot;rgt,in1&quot;</span><span class="p">,</span>
    <span class="p">},</span>
    <span class="s2">&quot;ports&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;in0&quot;</span><span class="p">:</span> <span class="s2">&quot;lft,in0&quot;</span><span class="p">,</span>
        <span class="s2">&quot;out0&quot;</span><span class="p">:</span> <span class="s2">&quot;rgt,out0&quot;</span><span class="p">,</span>
        <span class="s2">&quot;out1&quot;</span><span class="p">:</span> <span class="s2">&quot;rgt,out1&quot;</span><span class="p">,</span>
    <span class="p">},</span>
<span class="p">}</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="LogicalNetlist">LogicalNetlist<a class="anchor-link" href="#LogicalNetlist"> </a></h4>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>a <a href="/sax/typing.html#LogicalNetlist"><code>LogicalNetlist</code></a> is a subset of the more general <a href="/sax/typing.html#Netlist"><code>Netlist</code></a>.  It only contains the logical connections and instance names. Not the actual instances. This data structure is mostly used for internal use only.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">LogicalNetlist</span> <span class="o">=</span> <span class="n">TypedDict</span><span class="p">(</span>
    <span class="s2">&quot;LogicalNetlist&quot;</span><span class="p">,</span>
    <span class="p">{</span>
        <span class="s2">&quot;instances&quot;</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">],</span>
        <span class="s2">&quot;connections&quot;</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">],</span>
        <span class="s2">&quot;ports&quot;</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">],</span>
    <span class="p">},</span>
<span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<blockquote><p>Example:</p>
</blockquote>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">mzi_logical_netlist</span><span class="p">:</span> <span class="n">Netlist</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;instances&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;lft&quot;</span><span class="p">:</span> <span class="s2">&quot;mmi1x2&quot;</span><span class="p">,</span>
        <span class="s2">&quot;top&quot;</span><span class="p">:</span> <span class="s2">&quot;waveguide&quot;</span><span class="p">,</span>
        <span class="s2">&quot;rgt&quot;</span><span class="p">:</span> <span class="s2">&quot;mmi2x2&quot;</span><span class="p">,</span>
    <span class="p">},</span>
    <span class="s2">&quot;connections&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;lft,out0&quot;</span><span class="p">:</span> <span class="s2">&quot;top,in0&quot;</span><span class="p">,</span>
        <span class="s2">&quot;top,out0&quot;</span><span class="p">:</span> <span class="s2">&quot;rgt,in0&quot;</span><span class="p">,</span>
        <span class="s2">&quot;top,out1&quot;</span><span class="p">:</span> <span class="s2">&quot;rgt,in1&quot;</span><span class="p">,</span>
    <span class="p">},</span>
    <span class="s2">&quot;ports&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;in0&quot;</span><span class="p">:</span> <span class="s2">&quot;lft,in0&quot;</span><span class="p">,</span>
        <span class="s2">&quot;out0&quot;</span><span class="p">:</span> <span class="s2">&quot;rgt,out0&quot;</span><span class="p">,</span>
        <span class="s2">&quot;out1&quot;</span><span class="p">:</span> <span class="s2">&quot;rgt,out1&quot;</span><span class="p">,</span>
    <span class="p">},</span>
<span class="p">}</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Validation-and-runtime-type-checking:">Validation and runtime type-checking:<a class="anchor-link" href="#Validation-and-runtime-type-checking:"> </a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>{% include note.html content='the type-checking functions below are <strong>NOT</strong> very tight and hence should be used within the right context!' %}</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="is_float" class="doc_header"><code>is_float</code><a href="https://github.com/flaport/sax/tree/master/sax/typing_.py#L102" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>is_float</code>(<strong><code>x</code></strong>:<code>Any</code>)-&gt;<code>bool</code></p>
</blockquote>
<p>Check if an object is a <a href="/sax/typing.html#Float"><code>Float</code></a></p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">assert</span> <span class="n">is_float</span><span class="p">(</span><span class="mf">3.0</span><span class="p">)</span>
<span class="k">assert</span> <span class="ow">not</span> <span class="n">is_float</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="k">assert</span> <span class="ow">not</span> <span class="n">is_float</span><span class="p">(</span><span class="mf">3.0</span> <span class="o">+</span> <span class="mi">2</span><span class="n">j</span><span class="p">)</span>
<span class="k">assert</span> <span class="ow">not</span> <span class="n">is_float</span><span class="p">(</span><span class="n">jnp</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="mf">3.0</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">complex</span><span class="p">))</span>
<span class="k">assert</span> <span class="ow">not</span> <span class="n">is_float</span><span class="p">(</span><span class="n">jnp</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="is_complex" class="doc_header"><code>is_complex</code><a href="https://github.com/flaport/sax/tree/master/sax/typing_.py#L113" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>is_complex</code>(<strong><code>x</code></strong>:<code>Any</code>)-&gt;<code>bool</code></p>
</blockquote>
<p>check if an object is a <a href="/sax/typing.html#ComplexFloat"><code>ComplexFloat</code></a></p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">assert</span> <span class="ow">not</span> <span class="n">is_complex</span><span class="p">(</span><span class="mf">3.0</span><span class="p">)</span>
<span class="k">assert</span> <span class="ow">not</span> <span class="n">is_complex</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="k">assert</span> <span class="n">is_complex</span><span class="p">(</span><span class="mf">3.0</span> <span class="o">+</span> <span class="mi">2</span><span class="n">j</span><span class="p">)</span>
<span class="k">assert</span> <span class="n">is_complex</span><span class="p">(</span><span class="n">jnp</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="mf">3.0</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">complex</span><span class="p">))</span>
<span class="k">assert</span> <span class="ow">not</span> <span class="n">is_complex</span><span class="p">(</span><span class="n">jnp</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="is_complex_float" class="doc_header"><code>is_complex_float</code><a href="https://github.com/flaport/sax/tree/master/sax/typing_.py#L124" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>is_complex_float</code>(<strong><code>x</code></strong>:<code>Any</code>)-&gt;<code>bool</code></p>
</blockquote>
<p>check if an object is either a <a href="/sax/typing.html#ComplexFloat"><code>ComplexFloat</code></a> or a <a href="/sax/typing.html#Float"><code>Float</code></a></p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">assert</span> <span class="n">is_complex_float</span><span class="p">(</span><span class="mf">3.0</span><span class="p">)</span>
<span class="k">assert</span> <span class="ow">not</span> <span class="n">is_complex_float</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="k">assert</span> <span class="n">is_complex_float</span><span class="p">(</span><span class="mf">3.0</span> <span class="o">+</span> <span class="mi">2</span><span class="n">j</span><span class="p">)</span>
<span class="k">assert</span> <span class="n">is_complex_float</span><span class="p">(</span><span class="n">jnp</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="mf">3.0</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">complex</span><span class="p">))</span>
<span class="k">assert</span> <span class="ow">not</span> <span class="n">is_complex_float</span><span class="p">(</span><span class="n">jnp</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="is_sdict" class="doc_header"><code>is_sdict</code><a href="https://github.com/flaport/sax/tree/master/sax/typing_.py#L129" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>is_sdict</code>(<strong><code>x</code></strong>:<code>Any</code>)-&gt;<code>bool</code></p>
</blockquote>
<p>check if an object is an <a href="/sax/typing.html#SDict"><code>SDict</code></a> (a SAX S-dictionary)</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">assert</span> <span class="ow">not</span> <span class="n">is_sdict</span><span class="p">(</span><span class="nb">object</span><span class="p">())</span>
<span class="k">assert</span> <span class="n">is_sdict</span><span class="p">(</span><span class="n">_sdict</span><span class="p">)</span>
<span class="k">assert</span> <span class="ow">not</span> <span class="n">is_sdict</span><span class="p">(</span><span class="n">_scoo</span><span class="p">)</span>
<span class="k">assert</span> <span class="ow">not</span> <span class="n">is_sdict</span><span class="p">(</span><span class="n">_sdense</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="is_scoo" class="doc_header"><code>is_scoo</code><a href="https://github.com/flaport/sax/tree/master/sax/typing_.py#L134" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>is_scoo</code>(<strong><code>x</code></strong>:<code>Any</code>)-&gt;<code>bool</code></p>
</blockquote>
<p>check if an object is an <a href="/sax/typing.html#SCoo"><code>SCoo</code></a> (a SAX sparse S-matrix representation in COO-format)</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">assert</span> <span class="ow">not</span> <span class="n">is_scoo</span><span class="p">(</span><span class="nb">object</span><span class="p">)</span>
<span class="k">assert</span> <span class="ow">not</span> <span class="n">is_scoo</span><span class="p">(</span><span class="n">_sdict</span><span class="p">)</span>
<span class="k">assert</span> <span class="n">is_scoo</span><span class="p">(</span><span class="n">_scoo</span><span class="p">)</span>
<span class="k">assert</span> <span class="ow">not</span> <span class="n">is_scoo</span><span class="p">(</span><span class="n">_sdense</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="is_sdense" class="doc_header"><code>is_sdense</code><a href="https://github.com/flaport/sax/tree/master/sax/typing_.py#L139" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>is_sdense</code>(<strong><code>x</code></strong>:<code>Any</code>)-&gt;<code>bool</code></p>
</blockquote>
<p>check if an object is an <a href="/sax/typing.html#SDense"><code>SDense</code></a> (a SAX dense S-matrix representation)</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">assert</span> <span class="ow">not</span> <span class="n">is_sdense</span><span class="p">(</span><span class="nb">object</span><span class="p">)</span>
<span class="k">assert</span> <span class="ow">not</span> <span class="n">is_sdense</span><span class="p">(</span><span class="n">_sdict</span><span class="p">)</span>
<span class="k">assert</span> <span class="ow">not</span> <span class="n">is_sdense</span><span class="p">(</span><span class="n">_scoo</span><span class="p">)</span>
<span class="k">assert</span> <span class="n">is_sdense</span><span class="p">(</span><span class="n">_sdense</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="is_model" class="doc_header"><code>is_model</code><a href="https://github.com/flaport/sax/tree/master/sax/typing_.py#L144" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>is_model</code>(<strong><code>model</code></strong>:<code>Any</code>)-&gt;<code>bool</code></p>
</blockquote>
<p>check if a callable is a <a href="/sax/typing.html#Model"><code>Model</code></a> (a callable returning an <a href="/sax/typing.html#SType"><code>SType</code></a>)</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">good_model</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">jnp</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="mf">3.0</span><span class="p">),</span> <span class="n">y</span><span class="o">=</span><span class="n">jnp</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="mf">4.0</span><span class="p">))</span> <span class="o">-&gt;</span> <span class="n">SDict</span><span class="p">:</span>
    <span class="k">return</span> <span class="p">{(</span><span class="s2">&quot;in0&quot;</span><span class="p">,</span> <span class="s2">&quot;out0&quot;</span><span class="p">):</span> <span class="n">jnp</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="mf">3.0</span><span class="p">)}</span>
<span class="k">assert</span> <span class="n">is_model</span><span class="p">(</span><span class="n">good_model</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">bad_model</span><span class="p">(</span><span class="n">positional_argument</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="n">jnp</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="mf">3.0</span><span class="p">),</span> <span class="n">y</span><span class="o">=</span><span class="n">jnp</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="mf">4.0</span><span class="p">))</span> <span class="o">-&gt;</span> <span class="n">SDict</span><span class="p">:</span>
    <span class="k">return</span> <span class="p">{(</span><span class="s2">&quot;in0&quot;</span><span class="p">,</span> <span class="s2">&quot;out0&quot;</span><span class="p">):</span> <span class="n">jnp</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="mf">3.0</span><span class="p">)}</span>
<span class="k">assert</span> <span class="ow">not</span> <span class="n">is_model</span><span class="p">(</span><span class="n">bad_model</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="is_model_factory" class="doc_header"><code>is_model_factory</code><a href="https://github.com/flaport/sax/tree/master/sax/typing_.py#L173" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>is_model_factory</code>(<strong><code>model</code></strong>:<code>Any</code>)-&gt;<code>bool</code></p>
</blockquote>
<p>check if a callable is a model function.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>{% include note.html content='For a <code>Callable</code> to be considered a <a href="/sax/typing.html#ModelFactory"><code>ModelFactory</code></a> in SAX, it <strong>MUST</strong> have a <code>Callable</code> or <a href="/sax/typing.html#Model"><code>Model</code></a> return annotation. Otherwise SAX will view it as a <a href="/sax/typing.html#Model"><code>Model</code></a> and things might break!' %}</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">func</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n">Model</span><span class="p">:</span>
    <span class="o">...</span>
    
<span class="k">assert</span> <span class="n">is_model_factory</span><span class="p">(</span><span class="n">func</span><span class="p">)</span> <span class="c1"># yes, we only check the annotation for now...</span>

<span class="k">def</span> <span class="nf">func</span><span class="p">():</span>
    <span class="o">...</span>
    
<span class="k">assert</span> <span class="ow">not</span> <span class="n">is_model_factory</span><span class="p">(</span><span class="n">func</span><span class="p">)</span> <span class="c1"># yes, we only check the annotation for now...</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="validate_model" class="doc_header"><code>validate_model</code><a href="https://github.com/flaport/sax/tree/master/sax/typing_.py#L183" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>validate_model</code>(<strong><code>model</code></strong>:<code>Callable</code>)-&gt;<code>None</code></p>
</blockquote>
<p>Validate the parameters of a model</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">good_model</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">jnp</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="mf">3.0</span><span class="p">),</span> <span class="n">y</span><span class="o">=</span><span class="n">jnp</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="mf">4.0</span><span class="p">))</span> <span class="o">-&gt;</span> <span class="n">SDict</span><span class="p">:</span>
    <span class="k">return</span> <span class="p">{(</span><span class="s2">&quot;in0&quot;</span><span class="p">,</span> <span class="s2">&quot;out0&quot;</span><span class="p">):</span> <span class="n">jnp</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="mf">3.0</span><span class="p">)}</span>


<span class="k">assert</span> <span class="n">validate_model</span><span class="p">(</span><span class="n">good_model</span><span class="p">)</span> <span class="ow">is</span> <span class="kc">None</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">bad_model</span><span class="p">(</span><span class="n">positional_argument</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="n">jnp</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="mf">3.0</span><span class="p">),</span> <span class="n">y</span><span class="o">=</span><span class="n">jnp</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="mf">4.0</span><span class="p">))</span> <span class="o">-&gt;</span> <span class="n">SDict</span><span class="p">:</span>
    <span class="k">return</span> <span class="p">{(</span><span class="s2">&quot;in0&quot;</span><span class="p">,</span> <span class="s2">&quot;out0&quot;</span><span class="p">):</span> <span class="n">jnp</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="mf">3.0</span><span class="p">)}</span>


<span class="k">with</span> <span class="n">raises</span><span class="p">(</span><span class="ne">ValueError</span><span class="p">):</span>
    <span class="n">validate_model</span><span class="p">(</span><span class="n">bad_model</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="is_instance" class="doc_header"><code>is_instance</code><a href="https://github.com/flaport/sax/tree/master/sax/typing_.py#L196" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>is_instance</code>(<strong><code>instance</code></strong>:<code>Any</code>)-&gt;<code>bool</code></p>
</blockquote>
<p>check if a dictionary is an instance</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="is_netlist" class="doc_header"><code>is_netlist</code><a href="https://github.com/flaport/sax/tree/master/sax/typing_.py#L203" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>is_netlist</code>(<strong><code>netlist</code></strong>:<code>Any</code>)-&gt;<code>bool</code></p>
</blockquote>
<p>check if a dictionary is a netlist</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="is_stype" class="doc_header"><code>is_stype</code><a href="https://github.com/flaport/sax/tree/master/sax/typing_.py#L216" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>is_stype</code>(<strong><code>stype</code></strong>:<code>Any</code>)-&gt;<code>bool</code></p>
</blockquote>
<p>check if an object is an SDict, SCoo or SDense</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="is_singlemode" class="doc_header"><code>is_singlemode</code><a href="https://github.com/flaport/sax/tree/master/sax/typing_.py#L221" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>is_singlemode</code>(<strong><code>S</code></strong>:<code>Any</code>)-&gt;<code>bool</code></p>
</blockquote>
<p>check if an stype is single mode</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="is_multimode" class="doc_header"><code>is_multimode</code><a href="https://github.com/flaport/sax/tree/master/sax/typing_.py#L239" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>is_multimode</code>(<strong><code>S</code></strong>:<code>Any</code>)-&gt;<code>bool</code></p>
</blockquote>
<p>check if an stype is single mode</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="is_mixedmode" class="doc_header"><code>is_mixedmode</code><a href="https://github.com/flaport/sax/tree/master/sax/typing_.py#L248" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>is_mixedmode</code>(<strong><code>S</code></strong>:<code>Any</code>)-&gt;<code>bool</code></p>
</blockquote>
<p>check if an stype is neither single mode nor multimode (hence invalid)</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="SAX-return-type-helpers">SAX return type helpers<a class="anchor-link" href="#SAX-return-type-helpers"> </a></h2><blockquote><p>a.k.a SDict, SDense, SCoo helpers</p>
</blockquote>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Convert an <a href="/sax/typing.html#SDict"><code>SDict</code></a>, <a href="/sax/typing.html#SCoo"><code>SCoo</code></a> or <a href="/sax/typing.html#SDense"><code>SDense</code></a> into an <a href="/sax/typing.html#SDict"><code>SDict</code></a> (or convert a model generating any of these types into a model generating an <a href="/sax/typing.html#SDict"><code>SDict</code></a>):</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="sdict" class="doc_header"><code>sdict</code><a href="https://github.com/flaport/sax/tree/master/sax/typing_.py#L264" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>sdict</code>(<strong><code>S</code></strong>:<code>Union[Model, SType]</code>)-&gt;<code>Union[Model, SType]</code></p>
</blockquote>
<p>Convert an <a href="/sax/typing.html#SCoo"><code>SCoo</code></a> or <a href="/sax/typing.html#SDense"><code>SDense</code></a> to <a href="/sax/typing.html#SDict"><code>SDict</code></a></p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">assert</span> <span class="n">sdict</span><span class="p">(</span><span class="n">_sdict</span><span class="p">)</span> <span class="ow">is</span> <span class="n">_sdict</span>
<span class="k">assert</span> <span class="n">sdict</span><span class="p">(</span><span class="n">_scoo</span><span class="p">)</span> <span class="o">==</span> <span class="p">{</span>
    <span class="p">(</span><span class="s2">&quot;in0&quot;</span><span class="p">,</span> <span class="s2">&quot;in0&quot;</span><span class="p">):</span> <span class="mf">3.0</span><span class="p">,</span>
    <span class="p">(</span><span class="s2">&quot;in1&quot;</span><span class="p">,</span> <span class="s2">&quot;in0&quot;</span><span class="p">):</span> <span class="mf">1.0</span><span class="p">,</span>
    <span class="p">(</span><span class="s2">&quot;out0&quot;</span><span class="p">,</span> <span class="s2">&quot;out0&quot;</span><span class="p">):</span> <span class="mf">4.0</span><span class="p">,</span>
<span class="p">}</span>
<span class="k">assert</span> <span class="n">sdict</span><span class="p">(</span><span class="n">_sdense</span><span class="p">)</span> <span class="o">==</span> <span class="p">{</span>
    <span class="p">(</span><span class="s2">&quot;in0&quot;</span><span class="p">,</span> <span class="s2">&quot;in0&quot;</span><span class="p">):</span> <span class="mf">0.0</span><span class="p">,</span>
    <span class="p">(</span><span class="s2">&quot;in0&quot;</span><span class="p">,</span> <span class="s2">&quot;out0&quot;</span><span class="p">):</span> <span class="mf">1.0</span><span class="p">,</span>
    <span class="p">(</span><span class="s2">&quot;in0&quot;</span><span class="p">,</span> <span class="s2">&quot;in1&quot;</span><span class="p">):</span> <span class="mf">2.0</span><span class="p">,</span>
    <span class="p">(</span><span class="s2">&quot;out0&quot;</span><span class="p">,</span> <span class="s2">&quot;in0&quot;</span><span class="p">):</span> <span class="mf">3.0</span><span class="p">,</span>
    <span class="p">(</span><span class="s2">&quot;out0&quot;</span><span class="p">,</span> <span class="s2">&quot;out0&quot;</span><span class="p">):</span> <span class="mf">4.0</span><span class="p">,</span>
    <span class="p">(</span><span class="s2">&quot;out0&quot;</span><span class="p">,</span> <span class="s2">&quot;in1&quot;</span><span class="p">):</span> <span class="mf">5.0</span><span class="p">,</span>
    <span class="p">(</span><span class="s2">&quot;in1&quot;</span><span class="p">,</span> <span class="s2">&quot;in0&quot;</span><span class="p">):</span> <span class="mf">6.0</span><span class="p">,</span>
    <span class="p">(</span><span class="s2">&quot;in1&quot;</span><span class="p">,</span> <span class="s2">&quot;out0&quot;</span><span class="p">):</span> <span class="mf">7.0</span><span class="p">,</span>
    <span class="p">(</span><span class="s2">&quot;in1&quot;</span><span class="p">,</span> <span class="s2">&quot;in1&quot;</span><span class="p">):</span> <span class="mf">8.0</span><span class="p">,</span>
<span class="p">}</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Convert an <a href="/sax/typing.html#SDict"><code>SDict</code></a>, <a href="/sax/typing.html#SCoo"><code>SCoo</code></a> or <a href="/sax/typing.html#SDense"><code>SDense</code></a> into an <a href="/sax/typing.html#SCoo"><code>SCoo</code></a> (or convert a model generating any of these types into a model generating an <a href="/sax/typing.html#SCoo"><code>SCoo</code></a>):</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="scoo" class="doc_header"><code>scoo</code><a href="https://github.com/flaport/sax/tree/master/sax/typing_.py#L319" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>scoo</code>(<strong><code>S</code></strong>:<code>Union[Callable, SType]</code>)-&gt;<code>Union[Callable, SCoo]</code></p>
</blockquote>
<p>Convert an <a href="/sax/typing.html#SDict"><code>SDict</code></a> or <a href="/sax/typing.html#SDense"><code>SDense</code></a> to <a href="/sax/typing.html#SCoo"><code>SCoo</code></a></p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">assert</span> <span class="n">scoo</span><span class="p">(</span><span class="n">_scoo</span><span class="p">)</span> <span class="ow">is</span> <span class="n">_scoo</span>
<span class="k">assert</span> <span class="n">scoo</span><span class="p">(</span><span class="n">_sdict</span><span class="p">)</span> <span class="o">==</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mf">3.0</span><span class="p">,</span> <span class="p">{</span><span class="s2">&quot;in0&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;out0&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">})</span>
<span class="n">Si</span><span class="p">,</span> <span class="n">Sj</span><span class="p">,</span> <span class="n">Sx</span><span class="p">,</span> <span class="n">port_map</span> <span class="o">=</span> <span class="n">scoo</span><span class="p">(</span><span class="n">_sdense</span><span class="p">)</span>  <span class="c1"># type: ignore</span>
<span class="n">np</span><span class="o">.</span><span class="n">testing</span><span class="o">.</span><span class="n">assert_array_equal</span><span class="p">(</span><span class="n">Si</span><span class="p">,</span> <span class="n">jnp</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">]))</span>
<span class="n">np</span><span class="o">.</span><span class="n">testing</span><span class="o">.</span><span class="n">assert_array_equal</span><span class="p">(</span><span class="n">Sj</span><span class="p">,</span> <span class="n">jnp</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]))</span>
<span class="n">np</span><span class="o">.</span><span class="n">testing</span><span class="o">.</span><span class="n">assert_array_almost_equal</span><span class="p">(</span><span class="n">Sx</span><span class="p">,</span> <span class="n">jnp</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">,</span> <span class="mf">3.0</span><span class="p">,</span> <span class="mf">4.0</span><span class="p">,</span> <span class="mf">5.0</span><span class="p">,</span> <span class="mf">6.0</span><span class="p">,</span> <span class="mf">7.0</span><span class="p">,</span> <span class="mf">8.0</span><span class="p">]))</span>
<span class="k">assert</span> <span class="n">port_map</span> <span class="o">==</span> <span class="p">{</span><span class="s2">&quot;in0&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;in1&quot;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s2">&quot;out0&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">}</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Convert an <a href="/sax/typing.html#SDict"><code>SDict</code></a>, <a href="/sax/typing.html#SCoo"><code>SCoo</code></a> or <a href="/sax/typing.html#SDense"><code>SDense</code></a> into an <a href="/sax/typing.html#SDense"><code>SDense</code></a> (or convert a model generating any of these types into a model generating an <a href="/sax/typing.html#SDense"><code>SDense</code></a>):</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="sdense" class="doc_header"><code>sdense</code><a href="https://github.com/flaport/sax/tree/master/sax/typing_.py#L373" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>sdense</code>(<strong><code>S</code></strong>:<code>Union[Callable, SType]</code>)-&gt;<code>Union[Callable, SDense]</code></p>
</blockquote>
<p>Convert an <a href="/sax/typing.html#SDict"><code>SDict</code></a> or <a href="/sax/typing.html#SCoo"><code>SCoo</code></a> to <a href="/sax/typing.html#SDense"><code>SDense</code></a></p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">assert</span> <span class="n">sdense</span><span class="p">(</span><span class="n">_sdense</span><span class="p">)</span> <span class="ow">is</span> <span class="n">_sdense</span>
<span class="n">Sd</span><span class="p">,</span> <span class="n">port_map</span> <span class="o">=</span> <span class="n">sdense</span><span class="p">(</span><span class="n">_scoo</span><span class="p">)</span>  <span class="c1"># type: ignore</span>
<span class="n">Sd_</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mf">3.0</span> <span class="o">+</span> <span class="mf">0.0</span><span class="n">j</span><span class="p">,</span> <span class="mf">0.0</span> <span class="o">+</span> <span class="mf">0.0</span><span class="n">j</span><span class="p">,</span> <span class="mf">0.0</span> <span class="o">+</span> <span class="mf">0.0</span><span class="n">j</span><span class="p">],</span>
                 <span class="p">[</span><span class="mf">0.0</span> <span class="o">+</span> <span class="mf">0.0</span><span class="n">j</span><span class="p">,</span> <span class="mf">4.0</span> <span class="o">+</span> <span class="mf">0.0</span><span class="n">j</span><span class="p">,</span> <span class="mf">0.0</span> <span class="o">+</span> <span class="mf">0.0</span><span class="n">j</span><span class="p">],</span>
                 <span class="p">[</span><span class="mf">1.0</span> <span class="o">+</span> <span class="mf">0.0</span><span class="n">j</span><span class="p">,</span> <span class="mf">0.0</span> <span class="o">+</span> <span class="mf">0.0</span><span class="n">j</span><span class="p">,</span> <span class="mf">0.0</span> <span class="o">+</span> <span class="mf">0.0</span><span class="n">j</span><span class="p">]])</span>

<span class="n">np</span><span class="o">.</span><span class="n">testing</span><span class="o">.</span><span class="n">assert_array_almost_equal</span><span class="p">(</span><span class="n">Sd</span><span class="p">,</span> <span class="n">Sd_</span><span class="p">)</span>
<span class="k">assert</span> <span class="n">port_map</span> <span class="o">==</span> <span class="p">{</span><span class="s2">&quot;in0&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;in1&quot;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s2">&quot;out0&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">}</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="modelfactory" class="doc_header"><code>modelfactory</code><a href="https://github.com/flaport/sax/tree/master/sax/typing_.py#L412" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>modelfactory</code>(<strong><code>func</code></strong>)-&gt;<code>None</code></p>
</blockquote>
<p>Decorator that marks a function as <a href="/sax/typing.html#ModelFactory"><code>ModelFactory</code></a></p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

</div>
 

